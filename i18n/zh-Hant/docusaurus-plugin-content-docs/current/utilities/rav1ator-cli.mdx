---
title: rav1ator-cli
sidebar_position: 6
templating: true
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# rAV1ator CLI

rAV1ator CLI，或稱 `rav1ator-cli`，是一個 TUI 工具，為使用 [Av1an](../utilities/av1an.mdx) 執行影片編碼提供了互動式的命令行界面。它支援使用多種不同的編碼器，包括 [rav1e](../encoders/rav1e.mdx)、[aomenc](../encoders/aomenc.mdx)（特別是 aom-av1-lavish，如 aomenc 頁面所述）、[SVT-AV1](../encoders/SVT-AV1.mdx)、[x265](../encoders/x265.mdx) 和 [x264](../encoders/x264.mdx) 進行編碼。

```bash
~ > rav1ator-cli -h
rAV1ator: CLI Edition_ v0.2.0

使用說明：
	rav1ator-cli [輸入檔案] [輸出檔案] [--offline]

依賴項目 (Arch):
	rust ffmpeg python mkvtoolnix-cli vapoursynth gum numactl l-smash vapoursynth-plugin-lsmashsource av1an ffms2

選項：（目前一次只能使用一個選項）
	-h, --help			顯示幫助訊息
	-l, --last-used		顯示歷史記錄中最後一次使用的編碼設定
	-f, --full-history	顯示 ".rav1ator-cli-history" 檔案中的完整歷史記錄
	-b, --binaries		只安裝二進位檔案，然後退出
	-x, --offline		不要檢查更新
	-a, --batch			批量編碼。此標誌後指定目錄中的所有影片檔案都將進行編碼
```

rAV1ator CLI 的功能包括：

- 自動檢查軟體是否已安裝及為最新版本，無需依賴套件管理器
- 下載經過 AVX2 優化且多數情況下使用 -O3 -flto 編譯的編碼器二進制檔，並提供詳細的安裝指引
- 記錄編碼歷史，並允許用戶查看完整的歷史記錄或最近使用的命令
- 支援批量編碼，可使用相同設定對整個目錄中的所有影片檔案進行編碼
- 支援 x264、x265、aomenc、SVT-AV1 或 rav1e 編碼器，允許設定速度預設值、CRF/品質值、FFmpeg 參數和編碼器參數
- 根據用戶選擇的設定生成 Av1an 編碼命令，並執行這些命令將輸入影片編碼為 MKV 輸出
- 支援從頭編碼或恢復上一次的 rAV1ator CLI 編碼過程
- 提供豐富的互動功能，如加載指示器、提示和下拉選單
- 自動通過 SHA256 哈希校驗二進制檔案的錯誤，確保安全性和便捷性

總而言之，該工具旨在提供一種方便的命令行影片編碼方式，並帶來有用的視覺反饋。互動提示能夠幫助用戶在不具備深厚編碼知識的情況下選擇適當的編碼設定。

<img width="640" height="360" src="https://raw.githubusercontent.com/av1-community-contributors/images/main/rav1ator_cli_demo1.avif" alt="rAV1ator-cli: Demo 1"/>

<img width="640" height="360" src="https://raw.githubusercontent.com/av1-community-contributors/images/main/rav1ator_cli_demo2.avif" alt="rAV1ator-cli: Demo 2"/>

## 安裝指南

rAV1ator CLI 原生支援 Linux 系統，並透過 WSL2 支援 Windows 系統。以下是 WSL2 的設定教程。macOS 系統目前不支援。

## Linux（Arch 系統）

以下是針對 Arch Linux 的安裝說明。其他發行版的操作應該類似，Arch 特有的套件會特別標註。如果你使用的是 Ubuntu，請參考本站 [AV1 for Dummies](https://wiki.x266.mov/blog/av1-encoding-for-dummies) 博文中的相關部分。

如果你使用其他發行版並希望能夠遵循這些指示，請查看 [Linux（其他發行版）](#linux-other) 部分。

0. 首先，先更新你的系統。在 Arch 上執行以下命令：
```bash
sudo pacman -Syu
```

1. 安裝 `yay`（僅限 Arch 系統），執行以下步驟：
```bash
sudo pacman -S --needed base-devel git
git clone https://aur.archlinux.org/yay.git
cd yay && makepkg -si
```

2. 接下來，安裝 rAV1ator-cli 的所有依賴項。你可以通過以下命令完成：
```bash
yay -Syu openssl ffmpeg python mkvtoolnix-cli vapoursynth gum numactl l-smash vapoursynth-plugin-lsmashsource av1an ffms2
```

1. 安裝 rav1ator-cli：
```bash
curl -sOJ https://raw.githubusercontent.com/gianni-rosato/rav1ator-cli/main/rav1ator-cli && chmod +x rav1ator-cli
sudo cp rav1ator-cli /usr/local/bin
```

## Linux（其他系統）

如果你使用的是 Ubuntu，請參考本站 [AV1 for Dummies](https://wiki.x266.mov/blog/av1-encoding-for-dummies) 博文中的相關部分，以了解不使用 Distrobox 的詳細方法。不過，使用 Distrobox 可以讓你在其他發行版上享受 Arch 系統快速的套件管理，這對初學者來說通常比 Docker 更容易掌握，而且 Distrobox 其實在背後仍然使用 Docker 或 Podman。本教程將重點介紹如何使用 Distrobox 和 Podman。

0. 在你所選擇的發行版上安裝 Distrobox 和 Podman。請查閱相關安裝指南，並確保一切設定妥當。

1. 如果你已經在使用 Podman，或者你的 Arch 鏡像已過期，建議執行 `podman image rm docker.io/archlinux/archlinux:latest` 來刪除舊的映像檔案。如果不確定，執行此命令也無妨。**每次遇到 Distrobox 創建問題時，都建議在創建新 Distrobox 前進行此操作**。

2. 接下來，執行 `distrobox-create --name rvcli-box --image archlinux:latest` 來創建一個名為 "rvcli-box" 的 Distrobox 容器。名稱可以自行設定，但本教程中我們將使用這個名稱。

3. 執行 `distrobox enter rvcli-box` 進入 Distrobox。現在，你的系統將在現有發行版內執行 Arch Linux！

4. 首先，執行 `sudo pacman -Syu` 更新系統。

5. 接下來，執行 `sudo pacman -S --needed base-devel git && git clone https://aur.archlinux.org/yay.git && cd yay && makepkg -si` 來安裝必要的開發工具。

6. 最後，執行 `yay -Syu openssl ffmpeg python mkvtoolnix-cli vapoursynth gum numactl l-smash vapoursynth-plugin-lsmashsource av1an ffms2` 安裝所需的依賴軟體。

7. 下載 rav1ator-cli：`curl -sOJ https://raw.githubusercontent.com/gianni-rosato/rav1ator-cli/main/rav1ator-cli && chmod +x rav1ator-cli`

8. 將 rav1ator-cli 複製到 /usr/local/bin：`sudo cp rav1ator-cli /usr/local/bin`

9. 想要退出 Distrobox，只需按 `Ctrl` + `D` 即可。

完成！執行 `rav1ator-cli -h` 來獲取入門指引。祝你好運！

## Windows

:::note Windows
The content in this entry was written by pat-e, or `pate` on Discord. This tutorial focuses on Windows 11.
:::

**Enable WSL2 on Windows 11 and Install "ArchWSL2"** by pat-e

### Basic installtion

1.  Open the Terminal as Administrator:  
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/01_wsl_rv-cli.avif)
2.  In the Command-Prompt, enter the following to install WSL:  
    
    ```pwsh
    wsl.exe --install --no-distribution
    ```
    
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/02_wsl_rv-cli.avif)  
      
    If the "Host Process for Windows Services" asks for allowing changes, approve it (Press "Yes"):  
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/03_wsl_rv-cli.avif)
3.  Once the installation of WSL is finished, restart your Computer:  
    
    ```pwsh
    shutdown -r -f -t 1
    ```
    
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/04_wsl_rv-cli.avif)
4.  From [This GitHub link](https://github.com/sileshn/ArchWSL2), download the latest release of ArchWSL2 in the Releases section:  
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/06_wsl_rv-cli.avif)
5.  On your SSD, create a folder where we will place the ArchWSL2 files. This folder **must be kept and never deleted** as this will contain the base files for this distribution. It is advised to use an SSD instead of an HDD. The storage must be local storage, not a network-share or a removable disk. In our example, we will create a folder located at C:\\Stuff\\ArchWSL2;  
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/07_wsl_rv-cli.avif)  
      
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/08_wsl_rv-cli.avif)

6.  Extract the downloaded ZIP of "ArchWSL2" into your newly created folder:  
      
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/09_wsl_rv-cli.avif)

7.  Once extracted, start the extracted "Arch.exe":

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/10_wsl_rv-cli.avif)

8.  On first start, the program will create a virtual disk (VHDx). Once finished, press "Enter" to continue (it will close the window)

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/11_wsl_rv-cli.avif)  
      
    
9.  Once the virtual hard disk is created, restart the "arch.exe" again. It will finish some steps and ask for creating a new user-account. **This account is completely separate from your Windows user.** Please remember the username and password you use.

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/12_wsl_rv-cli.avif)  
      
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/13_wsl_rv-cli.avif)

10.  The Window will close and reopen again. As first step, update all packages. As your account you created earlier is in the sudo-group, you have to enter your password again as confirmation.

    ```bash
    sudo pacman -Syu
    ```
    
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/14_wsl_rv-cli.avif)

11.  Approve the installation of all the updates (Type "y"):

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/15_wsl_rv-cli.avif)

12.  Done... You can now use ArchWSL2.

### After the Installation and Cleanup, How Do I Start Arch?

For the start of Arch, there are 2 steps possible:

1.  You can just start "wsl" form the command prompt, terminal or "Windows Search":  

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/20_wsl_rv-cli.avif)  
      
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/21_wsl_rv-cli.avif)

2.  As another option, you can create a Shortcut to the "arch.exe" in the Installation-Folder:

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/22_wsl_rv-cli.avif)  

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/23_wsl_rv-cli.avif)  
      
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/24_wsl_rv-cli.avif)  

**Hint**: When you open the "arch.exe", you will be placed into the directory where also the "arch.exe" is located. To change to your home directory, just enter the command below:
    ```bash
    cd ~
    ```
      
![](https://raw.githubusercontent.com/av1-community-contributors/images/main/25_wsl_rv-cli.avif)

### Unlock WSL RAM Usage (Optional)

**Hint**: WSL caps RAM usage at 50% of the total RAM available on your system.

When you start the VM, you will see that you only will only have 50% of your total memory available:  

![](https://raw.githubusercontent.com/av1-community-contributors/images/main/26_wsl_rv-cli.avif)

To allow more memory, you need to place a config-file in your profile-folder in Windows. See the instructions below:

1.  Open "notepad.exe" and enter the following:  
    
    ```txt
    [wsl2]
    memory=12GB
    ```
    
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/27_wsl_rv-cli.avif)
2.  The amount of memory should never be more than current memory. Set it to total memory minus 4GB to leave enough left over for Windows. In my example, Windows has 16GB of RAM available, so I select the memory to be 12GB.  
      
    
3.  When saving the file, enter the following as filename:  
    
    `%userprofile%`
    
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/28_wsl_rv-cli.avif)

4.  When pressing enter, the directory will switch to your user-profile folder:

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/29_wsl_rv-cli.avif)

5.  Select the "Save as type" to "All files (\*.\*)" and save as the following filename:
    
    `.wslconfig`
    
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/30_wsl_rv-cli.avif)  
      
    Make sure the file is saved as `.wslconfig`. Then exit notepad.
6.  Exit any current running WSL / Arch (exit):

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/31_wsl_rv-cli.avif)

7.  Open the Terminal as Administrator and "shutdown" any running WSL:  
    
    ```pwsh
    wsl --shutdown
    ```
    
    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/32_wsl_rv-cli.avif)

8.  Restart WSL again and check the memory settings from within Arch by running the following command:

    ```bash
    free -h
    ```

    ![](https://raw.githubusercontent.com/av1-community-contributors/images/main/33_wsl_rv-cli.avif)

If you've made it this far, you should be more than ready to encode. We hope you enjoy rAV1ator CLI!

## macOS

No macOS support is provided at this time. It is definitely technically feasible, and I may produce a separate tool in the future with proper macOS binaries, though this would be a burden to keep up considering I don't currently see any demand for a port.

### Troubleshooting

- If your encode features a grey screen flashing occaisonally in the output, create a lossless intermediary of your source with x264 `-qp 0`. This happens because of VC-1 decoding errors, and is not something I can fix.
- If you have any more questions, please join the [AV1 for Dummies Discord server](https://discord.gg/bbQD5MjDr3). There is a rAV1ator CLI channel over there, and I am always happy to talk!

---
title: FFV1
sidebar_position: 12
---

# FFV1

:::danger 我們需要你！
此部分需要更多內容。如果你有意協助，請參考我們的 [貢獻指南](../contribution-guide.mdx) 並開始貢獻！
:::

[FFV1](https://datatracker.ietf.org/doc/html/rfc9043) 是一款無損的intra-frame編碼器，專為存檔與保存用途設計。這個編碼器由 Michael Niedermayer 創建，並且是 [FFmpeg](../utilities/ffmpeg.mdx) 項目的一部分。FFV1 支援廣泛的色彩空間，能夠處理 YUV 和 RGB 內容，也包括透明度通道，色彩深度範圍從 8 位元到 16 位元（對於 RGB 則只支援到 14 位元）。相比其他無損視訊編碼器如 [UT Video](../video/utvideo.mdx)，FFV1 的平行化支持良好，並且壓縮率極高，但相對而言會消耗更多資源。

## 歷史

FFV1 編碼器於 2003 年被合併進 FFmpeg 專案，然而其比特流規範在 2006 年被凍結（正式定為 FFV1 版本 0）。隨後在 2009 年發布了版本 1，擴展了對更多視訊位深的支援。

版本 2 從未正式發布，只存在於實驗形式。

第三個比特流版本於 2013 年被凍結，並且截至 2024 年仍然是最新版本。此版本增加了多執行緒支持和幀完整性檢查。

第四個版本 [即將推出](https://datatracker.ietf.org/doc/draft-ietf-cellar-ffv1-v4/)，可能會帶來對更多色彩空間的更好支持、壓縮改進以及 [可能](https://mailarchive.ietf.org/arch/msg/cellar/gFydpu8BKAgzspvy6Mvbpsrg5yY/) 的正式幀間預測支持。
## Usage

```bash title="Fast, heavily multithreaded"
ffmpeg -i input.mkv -c:v ffv1 -slices 16 out.mkv
```

```bash title="Slow, highest compression"
ffmpeg -i input.mkv -c:v ffv1 -g 60 -slices 4 -context 1 -coder 2 out.mkv
```

```bash title="Recommended for archival purposes, high compression, multithreaded"
ffmpeg -i input.mkv -c:v ffv1 -g 1 -slices 16 -slicecrc 1 -context 1 -coder 2 out.mkv
```

### Options
- `slices` - Slices divide frame into multiple parts that can be encoded and decoded in parallel. Can only be one of: [`4`, `6`, `9`, `12`, `16`, `24`, `30`] where `4` is the default.
- `slicecrc` - Setting it to `1` will enable decoder to detect errors in the bitstream. Must be enabled for archival use. Can be eitner `0` or `1`.
- `context` - Setting it to `1` will make encoder use larger context size which usually leads to better compression. Can be eitner `0` or `1`.
- `coder` - Sets entropy coding method:
  - `0` - Golomb-Rice (faster, default)
  - `1` - Range Coder (used for higher bit depths and better compression)
  - `2` - Range Coder with custom state transition table (almost the same as `1`)
- `g` - Sets `GOP size`. Must be `1` for archival use. [see below](#intra-frame-only-catch)

## intra-frame only catch

Intra-frame only codecs do not use common *inter*-frame video coding techniques such as [motion compensation](#TODO), reusing parts of surrounding frames or adapting encoding context based on them. Every frame is independent from one another. Common Intra-frame only codecs may include Motion JPEG (Lossy), Motion JPEG 2000 (Both) or [UT Video](../video/utvideo.mdx) (Lossless).

If you're careful reader you might have noticed that setting `GOP size` isn't a common characteristic amongst intra-frame only codecs.

In fact FFV1 can be considered an intra-frame codec only if `GOP size` is set to `1`. When it's larger than that, its context model depends on other frames found within the `GOP` which contradicts the definition of intra-frame only codec. The main reason why it's strongly recommended to set `GOP size` to `1` for archival purposes is that if one frame gets somehow corrupted, we only lost one frame. If `GOP size` was big we could loose much larger part of the video.

References:
- [Wikipedia](https://en.wikipedia.org/wiki/FFV1)
- [RFC9043](https://datatracker.ietf.org/doc/html/rfc9043)
- [FFmpeg Docs](https://trac.ffmpeg.org/wiki/Encode/FFV1)
- [This Thread](https://forum.shotcut.org/t/exporting-as-ffv1-change-form-to-support-lossless-parameters/41230/19?page=2)
- [This Question](https://video.stackexchange.com/questions/24874/what-does-the-context-parameter-mean-when-using-ffv1-in-ffmpeg)

